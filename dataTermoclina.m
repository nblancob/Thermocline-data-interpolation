% Created by Octave 5.2.0, Wed Nov 03 21:44:42 2021 -05 <mus@mus-UX410UAK>
% name: data
% type: matrix
% rows: 50
% columns: 2
% Interpolacion con los datos del ejercicio termoclina donde se tiene la
% termperatura en funcion de la profundidad, y se busca encontrar la franja
% correspondiente a la termoclina: la cual se define como una capa
% invisible en la que la temperatura desciende bruscamente.
 data=[0 29.499999999999996
 24.489795918367346 29.341163795752731
 48.979591836734691 29.112048077811
 73.469387755102034 28.783517308041009
 97.959183673469383 28.316431731321369
 122.44897959183673 27.660339729175298
 146.93877551020407 26.754245092466427
 171.42857142857142 25.531738854998878
 195.91836734693877 23.933232448021485
 220.40816326530611 21.926633479060467
 244.89795918367346 19.532876437948499
 269.38775510204079 16.84486940820803
 293.87755102040813 14.02395803958424
 318.36734693877548 11.266211579557543
 342.85714285714283 8.7509031352864177
 367.34693877551018 6.5977914063147738
 391.83673469387753 4.852600714267572
 416.32653061224488 3.4995565714833519
 440.81632653061223 2.4862566556297807
 465.30612244897958 1.7469075521540514
 489.79591836734693 1.2176384124760864
 514.28571428571422 0.84390922054051987
 538.77551020408157 0.5825546934059882
 563.26530612244892 0.40102134320512711
 587.75510204081627 0.27552414689052468
 612.24489795918362 0.18904841903626746
 636.73469387755097 0.12959494267626528
 661.22448979591832 0.088782910392894418
 685.71428571428567 0.060797109516913021
 710.20408163265301 0.04162054623543332
 734.69387755102036 0.028486851091103025
 759.18367346938771 0.019494887651261446
 783.67346938775506 0.013339995861180291
 808.16326530612241 0.009127721132867422
 832.65306122448976 0.0062452477514838385
 857.14285714285711 0.0042729098747626105
 881.63265306122446 0.0029234032756391463
 906.12244897959181 0.0020000807222237179
 930.61224489795916 0.001368365371966052
 955.10204081632651 0.0009361678525948824
 979.59183673469386 0.00064047677472809164
 1004.0816326530612 0.00043817913029647171
 1028.5714285714284 0.00029977752012196973
 1053.0612244897959 0.00020509062104190031
 1077.5510204081631 0.00014031112365800818
 1102.0408163265306 9.5992677905935771e-05
 1126.5306122448978 6.5672554321135831e-05
 1151.0204081632653 4.4929291498333544e-05
 1175.5102040816325 3.0737966755295352e-05
 1200 2.1029097652344305e-05];
 x=data(:,1)';
 y=data(:,2)';


 
%Interpolacion por trazadores cuadraticos
cuad=traz_cuadraticos(x,y);
figure(4);
plot(y,x,'o')
hold on;
for i=1:1:49
    pol_i=@(x) cuad(1,i)*x.^2+cuad(2,i)*x+cuad(3,i);
    xplo_i= x(i):0.1:x(i+1);
    ans_i=pol_i(xplo_i);
    plot(ans_i,xplo_i);
    hold on;
    ax = gca;
    ax.YDir = 'reverse';
end
%Interpolación lineal
xx=0:0.01:1200;
l=interp1(x,y,xx,'linear');
figure(1);
plot(y,x,'o',l,xx,'red');
ax = gca;
ax.YDir = 'reverse';
%Interpolacion cubica
c=interp1(x,y,xx,'cubic');
figure(2);
plot(y,x,"o",c,xx);
ax = gca;
ax.YDir = 'reverse';
%Interpolacion por lagrange
L=lagrange(x,y);
pol=@(x) L(50)+L(49)*x+L(48)*x.^2+L(47)*x.^3+L(46)*x.^4;
polx=0:0.1:100;
c=pol(polx);
figure(3)
plot(y(1:1:10),x(1:1:10),'o',c,polx);
ax = gca;
ax.YDir = 'reverse';
%Interpolación de vandermonde
v=interpolacion_vandermonde(x,y);
pol_van=@(x) v(1)+v(2)*x+v(3)*x.^2+v(4)*x.^3+v(5)*x.^5;
ans_van=pol_van(polx);
figure(5)
plot(y(1:1:10),x(1:1:10),'o',ans_van,polx);
ax = gca;
ax.YDir = 'reverse';

